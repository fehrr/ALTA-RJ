------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- QUERYS
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
vRP._prepare("login/selectAllowed", "SELECT whitelist FROM vrp_users WHERE id = @user_id")
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- FUNCTIONS
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
local accounts = {}

function accounts:getAccount(source)
    local user_id = vRP.getUserId(source)
    if user_id then
        local query = vRP.query("login/selectAllowed", { user_id = user_id })
        if #query > 0 and query[1].whitelist then return end

        TriggerClientEvent("openDiscordNui", source, user_id)
    end
end

function RegisterTunnel.requestAllowed()
    local source = source
    local user_id = vRP.getUserId(source)

    if user_id then
        local query = vRP.query("login/selectAllowed", { user_id = user_id })
        if #query > 0 and query[1].whitelist then
            return true
        end
    end

    return false
end

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- EXPORTS
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
exports('getAccount', function(...)
    accounts:getAccount(...)
end)